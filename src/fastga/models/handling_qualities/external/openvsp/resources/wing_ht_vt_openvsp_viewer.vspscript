//==== Create A Multi Section Wing and Change Some Parameters ====//

void main()
{
    //==== Add wing ====//
    string wid = AddGeom( "WING", "" );
    SetGeomName(wid, "Wing");
    string xsec_surf = GetXSecSurf( wid, 0 );
    string xsec = GetXSec( xsec_surf, 0 );

    //===== Insert A Couple More Sections =====//
    InsertXSec( wid, 1, XS_FILE_AIRFOIL );

    //===== Define wing global dimensions =====//
    SetParmVal( wid, "RotateAirfoilMatchDideralFlag", "WingGeom", 1.0 );
    SetParmVal( wid, "Tess_W", "Shape", 41 );
    SetParmVal( wid, "LECluster", "WingGeom", 0.7 );
    SetParmVal( wid, "TECluster", "WingGeom", 0.9 );
    SetParmVal( wid, "X_Rel_Location", "XForm", x_wing );
    SetParmVal( wid, "Z_Rel_Location", "XForm", z_wing );
    Update();

    //===== Define wing 1st Section ====//
    SetParmVal( wid, "Span", "XSec_1", y1_wing );
    SetParmVal( wid, "Root_Chord", "XSec_1", l2_wing );
    SetParmVal( wid, "Tip_Chord", "XSec_1", l2_wing );
    SetParmVal( wid, "Sweep", "XSec_1", 0.0 );
    SetParmVal( wid, "Sec_Sweep_Location", "XSec_1", 0.7 );
    SetParmVal( wid, "Sweep_Location", "XSec_1", 0 );
    SetParmVal( wid, "Dihedral", "XSec_1", 0.0 );
    SetParmVal( wid, "Twist", "XSec_1", 0.0 );
    SetParmVal( wid, "SectTess_U", "XSec_1", 8 );
    Update();

    //===== Define wing 2nd Section ====//
    SetParmVal( wid, "Span", "XSec_2", span2_wing );
    SetParmVal( wid, "Root_Chord", "XSec_2", l2_wing );
    SetParmVal( wid, "Tip_Chord", "XSec_2", l4_wing );
    SetParmVal( wid, "Sweep", "XSec_2", sweep_0_wing );
    SetParmVal( wid, "Sec_Sweep_Location", "XSec_2", 0.7 );
    SetParmVal( wid, "Sweep_Location", "XSec_2", 0 );
    SetParmVal( wid, "Dihedral", "XSec_2", dihedral_wing );
    SetParmVal( wid, "Twist", "XSec_2", twist_wing );
    SetParmVal( wid, "SectTess_U", "XSec_2", 33 );
    SetParmVal( wid, "OutCluster", "XSec_2", 0.9 );
    Update();

    //==== Change Airfoil 0 shape ====//
    ChangeXSecShape( xsec_surf, 0, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 0 );
    ReadFileAirfoil( xsec, airfoil_0_file );
    Update();

    //==== Change Airfoil 1 (y=y2) shape ====//
    ChangeXSecShape( xsec_surf, 1, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 1 );
    ReadFileAirfoil( xsec, airfoil_1_file );
    Update();

    //==== Change Airfoil 2 (y=y4) shape ====//
    ChangeXSecShape( xsec_surf, 2, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 2 );
    ReadFileAirfoil( xsec, airfoil_2_file );
    Update();


    //==== Add wing (HTP) ====//
    string hid = AddGeom( "WING", "" );
    SetGeomName(hid, "HTP");
    xsec_surf = GetXSecSurf( hid, 0 );

    //===== Define htp global dimensions =====//
    SetParmVal( hid, "RotateAirfoilMatchDideralFlag", "WingGeom", 1.0 );

    SetParmVal(hid, "Tess_W", "Shape", 31);
    SetParmVal( hid, "LECluster", "WingGeom", 0.7 );
    SetParmVal( hid, "TECluster", "WingGeom", 0.9 );
    SetParmVal( hid, "X_Rel_Location", "XForm", distance_htp );
    SetParmVal( hid, "Z_Rel_Location", "XForm", height_htp );
    Update();

    //===== Define HTP 1st Section ====//
    SetParmVal( hid, "Span", "XSec_1", semispan_htp );
    SetParmVal( hid, "Root_Chord", "XSec_1", root_chord_htp );
    SetParmVal( hid, "Tip_Chord", "XSec_1", tip_chord_htp );
    SetParmVal( hid, "Sweep", "XSec_1", sweep_25_htp );
    SetParmVal( hid, "Sweep_Location", "XSec_1", 0.25);
    SetParmVal( hid, "Dihedral", "XSec_1", dihedral_htp );
    SetParmVal( hid, "Twist", "XSec_1", twist_htp );
    SetParmVal( hid, "SectTess_U", "XSec_1", 25);
    Update();

    //==== Change Airfoils 0 shape  ====//
    ChangeXSecShape( xsec_surf, 0, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 0 );
    ReadFileAirfoil( xsec, airfoil_3_file );
    Update();

    //==== Change Airfoils 1 shape  ====//
    ChangeXSecShape( xsec_surf, 1, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 1 );
    ReadFileAirfoil( xsec, airfoil_4_file );
    Update();


    //==== Add wing (VTP) ====//
    string vid = AddGeom( "WING", "" );
    SetGeomName(vid, "VTP");
    xsec_surf = GetXSecSurf( vid, 0 );

    //===== Define vtp global dimensions =====//
    SetParmVal(vid, "Tess_W", "Shape", 31);
    SetParmVal( vid, "LECluster", "WingGeom", 0.7 );
    SetParmVal( vid, "TECluster", "WingGeom", 0.9 );
    SetParmVal( vid, "X_Rel_Rotation", "XForm", 90.0 );
    SetParmVal( vid, "X_Rel_Location", "XForm", distance_vtp );
    SetParmVal( vid, "Z_Rel_Location", "XForm", height_vtp );
    Update();

    //===== Define VTP 1st Section ====//
    SetParmVal( vid, "Span", "XSec_1", span_vtp );
    SetParmVal( vid, "Root_Chord", "XSec_1", root_chord_vtp );
    SetParmVal( vid, "Tip_Chord", "XSec_1", tip_chord_vtp );
    SetParmVal( vid, "Sweep", "XSec_1", sweep_25_vtp );
    SetParmVal( vid, "Sweep_Location", "XSec_1", 0.25);
    SetParmVal( vid, "SectTess_U", "XSec_1", 25);
    Update();

    //==== Change Airfoils 0 shape  ====//
    ChangeXSecShape( xsec_surf, 0, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 0 );
    ReadFileAirfoil( xsec, airfoil_5_file );
    Update();

    //==== Change Airfoils 1 shape  ====//
    ChangeXSecShape( xsec_surf, 1, XS_FILE_AIRFOIL );
    xsec = GetXSec( xsec_surf, 1 );
    ReadFileAirfoil( xsec, airfoil_6_file );
    Update();

    while ( GetNumTotalErrors() > 0 ) // Check For Errors
    {
    ErrorObj err = PopLastError();
    Print( err.GetErrorString() );
    }
}